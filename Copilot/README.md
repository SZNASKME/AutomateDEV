# Microsoft Copilot Integration

## р╕ар╕▓р╕Юр╕гр╕зр╕б
р╣Ар╕Др╕гр╕╖р╣Ир╕нр╕Зр╕бр╕╖р╕нр╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╣Бр╕ер╕░р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Др╕Ыр╕вр╕▒р╕З Microsoft Copilot р╣Вр╕Фр╕вр╣Гр╕Кр╣Й Direct Line API

## р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕З

### ЁЯУБ configs/
- **sendMessage.json**: р╣Др╕Яр╕ер╣Мр╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б

### ЁЯУБ SendMessage/
р╣Ар╕Бр╣Зр╕Ър╕кр╕Др╕гр╕┤р╕Ыр╕Хр╣Мр╕Хр╣Ир╕▓р╕Зр╣Ж р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Др╕Ыр╕вр╕▒р╕З Copilot

#### sendMessageOneTimes.py
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Др╕гр╕▒р╣Йр╕Зр╣Ар╕Фр╕╡р╕вр╕зр╣Др╕Ыр╕вр╕▒р╕З Microsoft Copilot

**р╕Яр╕╡р╣Ар╕Ир╕нр╕гр╣Мр╕лр╕ер╕▒р╕Б**:
- р╕Бр╕▓р╕гр╕Вр╕н token р╕кр╕│р╕лр╕гр╕▒р╕Ъ Direct Line API
- р╕кр╕гр╣Йр╕▓р╕З conversation session
- р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Бр╕ер╕░р╕гр╕▒р╕Ър╕Др╕│р╕Хр╕нр╕Ъ
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ retry mechanism
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ Thai locale (th-TH)

**р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓**:
```python
ops_copilot_token_url = "https://..."  # URL р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Вр╕н token
ops_copilot_input_text = "What is stonebranch?"  # р╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕кр╣Ир╕З
ops_copilot_maximum_retry = 3  # р╕Ир╕│р╕Щр╕зр╕Щр╕Др╕гр╕▒р╣Йр╕Зр╕Чр╕╡р╣Ир╕Ир╕░ retry
ops_copilot_retry_interval = 10  # р╕гр╕░р╕вр╕░р╣Ар╕зр╕ер╕▓р╕гр╕нр╕гр╕░р╕лр╕зр╣Ир╕▓р╕З retry (р╕зр╕┤р╕Щр╕▓р╕Чр╕╡)
```

#### sendMessageSequence.py
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕Зр╕лр╕ер╕▓р╕вр╕Др╕гр╕▒р╣Йр╕Зр╣Гр╕Щр╕Бр╕▓р╕гр╕кр╕Щр╕Чр╕Щр╕▓р╣Ар╕Фр╕╡р╕вр╕зр╕Бр╕▒р╕Щ

**р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤**:
- р╕гр╕▒р╕Бр╕йр╕▓ conversation context
- р╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕лр╕ер╕▓р╕вр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╣Гр╕Щр╕ер╕│р╕Фр╕▒р╕Ъ
- р╕Ир╕▒р╕Фр╕Бр╕▓р╕г session timeout

#### sendMessageUT.py
**р╕зр╕▒р╕Хр╕Цр╕╕р╕Ыр╕гр╕░р╕кр╕Зр╕Др╣М**: Unit tests р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ър╕Яр╕▒р╕Зр╕Бр╣Мр╕Кр╕▒р╕Щр╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б

**р╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ**:
- р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Вр╕н token
- р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕кр╕гр╣Йр╕▓р╕З conversation
- р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕кр╣Ир╕Зр╣Бр╕ер╕░р╕гр╕▒р╕Ър╕Вр╣Йр╕нр╕Др╕зр╕▓р╕б
- р╕Чр╕Фр╕кр╕нр╕Ъ error handling

## р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### 1. р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щ
```python
# р╣Бр╕Бр╣Йр╣Др╕В URL р╣Бр╕ер╕░ token р╣Гр╕Щ sendMessageOneTimes.py
ops_copilot_token_url = "YOUR_COPILOT_TOKEN_URL"
```

### 2. р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Др╕гр╕▒р╣Йр╕Зр╣Ар╕Фр╕╡р╕вр╕з
```python
python sendMessageOneTimes.py
```

### 3. р╕Бр╕▓р╕гр╕кр╣Ир╕Зр╕Вр╣Йр╕нр╕Др╕зр╕▓р╕бр╕Хр╣Ир╕нр╣Ар╕Щр╕╖р╣Ир╕нр╕З
```python
python sendMessageSequence.py
```

### 4. р╕Бр╕▓р╕гр╕гр╕▒р╕Щ Unit Tests
```python
python sendMessageUT.py
```

## р╕Вр╣Йр╕нр╕Бр╕│р╕лр╕Щр╕Ф
- Python 3.x
- requests library
- Microsoft Copilot Direct Line API access
- Valid authentication token

## р╕лр╕бр╕▓р╕вр╣Ар╕лр╕Хр╕╕
- р╕Хр╣Йр╕нр╕Зр╕бр╕╡ valid Direct Line API endpoint
- р╕Хр╣Йр╕нр╕Зр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ authentication р╣Гр╕лр╣Йр╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
- р╕гр╕нр╕Зр╕гр╕▒р╕Ъ locale th-TH р╕кр╕│р╕лр╕гр╕▒р╕Ър╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в